[
  {
    "id": "tcpip",
    "title": "TCP/IP Fundamentals",
    "sections": [
      {
        "type": "content",
        "heading": "โมเดล TCP/IP คืออะไร?",
        "text": "TCP/IP (Transmission Control Protocol / Internet Protocol) เป็นชุดกฎ (Protocol Suite) ที่ใช้สื่อสารบนอินเทอร์เน็ต แบ่งเป็น 4 ชั้น:\n1. Application Layer — HTTP, HTTPS, DNS, SSH, FTP\n2. Transport Layer — TCP (reliable), UDP (fast)\n3. Internet Layer — IP, ICMP, ARP\n4. Network Access Layer — Ethernet, Wi-Fi, MAC address\n\nทุก packet ที่ส่งผ่านเน็ตต้องผ่านทั้ง 4 ชั้นนี้ เข้าใจ TCP/IP = เข้าใจ networking ทั้งหมด"
      },
      {
        "type": "content",
        "heading": "TCP 3-Way Handshake",
        "text": "ก่อนส่งข้อมูลจริง TCP ต้อง จับมือ กัน 3 ขั้นตอน:\n1. SYN — Client ส่ง SYN packet ไป Server (ขอเชื่อมต่อ)\n2. SYN-ACK — Server ตอบกลับ SYN-ACK (ยืนยันว่ารับได้)\n3. ACK — Client ส่ง ACK (ยืนยันอีกครั้ง → เริ่มส่งข้อมูล)\n\nSYN Flood Attack: ถ้าผู้โจมตีส่ง SYN จำนวนมากโดยไม่ตอบ ACK จะทำให้ Server ค้าง (DoS Attack)"
      },
      {
        "type": "content",
        "heading": "IP Address & Subnetting",
        "text": "IP Address คือ ที่อยู่ ของอุปกรณ์ในเครือข่าย:\nIPv4: 192.168.1.100 (32 bits, 4 octets)\nIPv6: 2001:0db8:85a3::8a2e:0370:7334 (128 bits)\n\nPrivate IP Ranges (ใช้ในเครือข่ายภายใน):\n10.0.0.0/8 — Class A\n172.16.0.0/12 — Class B\n192.168.0.0/16 — Class C\n\nSubnet Mask:\n/24 = 255.255.255.0 — 254 hosts\n/16 = 255.255.0.0 — 65,534 hosts\n/8 = 255.0.0.0 — 16 million+ hosts"
      },
      {
        "type": "content",
        "heading": "Port Numbers ที่ต้องจำ",
        "text": "Port คือ ประตู ของ service บนเครื่อง:\nPort 20/21 — FTP (File Transfer)\nPort 22 — SSH (Secure Shell)\nPort 23 — Telnet (ไม่ปลอดภัย!)\nPort 25 — SMTP (Email)\nPort 53 — DNS (Domain Name)\nPort 80 — HTTP (Web)\nPort 443 — HTTPS (Web Secure)\nPort 3306 — MySQL\nPort 3389 — RDP (Remote Desktop)\nPort 8080 — HTTP Proxy/Alternate\n\nWell-known ports: 0-1023\nRegistered ports: 1024-49151\nDynamic ports: 49152-65535"
      },
      {
        "type": "code",
        "language": "bash",
        "code": "# ดู IP address ของเครื่อง\nip addr show\nifconfig\n\n# ดู routing table\nip route\nnetstat -r\n\n# ดู DNS resolution\nnslookup google.com\ndig google.com\n\n# ดู ARP table (MAC ↔ IP mapping)\narp -a\n\n# Ping ทดสอบ connectivity\nping -c 4 8.8.8.8\n\n# Traceroute ดูเส้นทาง packet\ntraceroute google.com"
      },
      {
        "type": "quiz",
        "question": "Port ใดใช้สำหรับ HTTPS?",
        "answer": "443",
        "hint": "เป็น port ที่ใช้ HTTP แบบเข้ารหัส (Secure)"
      },
      {
        "type": "quiz",
        "question": "TCP 3-Way Handshake มีขั้นตอนอะไรบ้าง?",
        "answer": "SYN, SYN-ACK, ACK",
        "hint": "เริ่มจาก SYN → Server ตอบ → Client ยืนยัน"
      },
      {
        "type": "quiz",
        "question": "IP range 192.168.0.0/16 เป็น IP ประเภทใด?",
        "answer": "Private IP",
        "hint": "ใช้ในเครือข่ายภายในเท่านั้น ไม่สามารถ route บน internet ได้"
      }
    ]
  },
  {
    "id": "packets",
    "title": "Packet Analysis",
    "sections": [
      {
        "type": "content",
        "heading": "โครงสร้างของ Network Packet",
        "text": "ทุก packet ที่ส่งผ่าน network ประกอบด้วย header หลายชั้นซ้อนกัน (Encapsulation):\n\nEthernet Frame:\n- Ethernet Header (14 bytes) — Source MAC, Dest MAC, Type\n- IP Header (20 bytes) — Source IP, Dest IP, TTL, Protocol\n- TCP/UDP Header (20/8 bytes) — Source Port, Dest Port, Flags\n- Payload (Data) — ข้อมูลจริงที่ส่ง\n\nการวิเคราะห์ packet = การแกะ header แต่ละชั้นเพื่อดูว่าข้อมูลมาจากไหน ไปไหน และเป็น protocol อะไร"
      },
      {
        "type": "content",
        "heading": "TCP Flags ที่ต้องรู้",
        "text": "TCP ใช้ flags เพื่อควบคุมการเชื่อมต่อ:\nSYN (S) — เริ่มการเชื่อมต่อ\nACK (A) — ยืนยันการรับข้อมูล\nFIN (F) — ขอปิดการเชื่อมต่อ\nRST (R) — รีเซ็ตการเชื่อมต่อ\nPSH (P) — ส่งข้อมูลทันที\nURG (U) — ข้อมูลเร่งด่วน\n\nFlag Combinations ที่น่าสงสัย:\nSYN only (ไม่มี ACK) — อาจเป็น SYN scan\nFIN+PSH+URG — XMAS scan (Nmap)\nNo flags — NULL scan\nRST จำนวนมาก — Port scan ถูก reject"
      },
      {
        "type": "content",
        "heading": "Protocol ที่พบบ่อย",
        "text": "TCP — Connection-oriented, reliable (HTTP, SSH, FTP)\nUDP — Connectionless, fast (DNS, DHCP, VoIP)\nICMP — Ping, Traceroute\nARP — MAC ↔ IP resolution\nDNS — Domain → IP translation\nHTTP/HTTPS — Web traffic\nTLS — Encrypted communication\n\nDNS Tunneling: ผู้โจมตีอาจซ่อน data ใน DNS queries เพื่อ bypass firewall\nARP Spoofing: ปลอม ARP reply เพื่อดักจับ traffic (Man-in-the-Middle)"
      },
      {
        "type": "quiz",
        "question": "TCP flag ใดใช้เริ่มการเชื่อมต่อ?",
        "answer": "SYN",
        "hint": "เป็น flag แรกของ 3-way handshake"
      },
      {
        "type": "quiz",
        "question": "XMAS scan ใช้ TCP flags อะไรรวมกัน?",
        "answer": "FIN+PSH+URG",
        "hint": "เหมือนไฟคริสต์มาส ที่ เปิดทุกอย่าง"
      }
    ]
  },
  {
    "id": "traffic",
    "title": "Network Traffic Monitoring",
    "sections": [
      {
        "type": "content",
        "heading": "ทำไมต้องตรวจสอบ Network Traffic?",
        "text": "Network Traffic Analysis (NTA) เป็นหัวใจของ Blue Team:\nตรวจจับ malware communication (C2 callback)\nระบุ data exfiltration (ข้อมูลรั่วไหล)\nวิเคราะห์ incident response\nตรวจสอบ policy compliance\n\nเครื่องมือหลัก:\ntcpdump — CLI packet capture\ntshark — Wireshark CLI version\nWireshark — GUI packet analyzer\nZeek (Bro) — Network security monitor"
      },
      {
        "type": "content",
        "heading": "tcpdump — Command Line Packet Capture",
        "text": "tcpdump เป็นเครื่องมือ capture packet ที่ใช้บ่อยที่สุดใน Linux\nSyntax: tcpdump [options] [filters]\n\nCommon Options:\n-i eth0 — เลือก interface\n-n — ไม่แปลง IP เป็นชื่อ\n-X — แสดง hex + ASCII\n-c 10 — จับแค่ 10 packets\n-w file.pcap — บันทึกเป็นไฟล์\n-r file.pcap — อ่านจากไฟล์"
      },
      {
        "type": "code",
        "language": "bash",
        "code": "# Capture traffic บน eth0\nsudo tcpdump -i eth0\n\n# Capture เฉพาะ port 80 (HTTP)\nsudo tcpdump -i eth0 port 80\n\n# Capture เฉพาะ IP ที่กำหนด\nsudo tcpdump -i eth0 host 192.168.1.100\n\n# TCP SYN packets only (detect port scan)\nsudo tcpdump -i eth0 \"tcp[tcpflags] & tcp-syn != 0\"\n\n# บันทึกเป็นไฟล์ pcap\nsudo tcpdump -i eth0 -w capture.pcap -c 1000\n\n# อ่านจากไฟล์ pcap แสดง hex dump\nsudo tcpdump -r capture.pcap -X -n"
      },
      {
        "type": "content",
        "heading": "tshark — Wireshark CLI",
        "text": "tshark มี filter ที่ทรงพลังกว่า tcpdump\n\nDisplay Filter ที่ใช้บ่อย:\nhttp — เฉพาะ HTTP traffic\ndns — เฉพาะ DNS queries\ntcp.flags.syn==1 — เฉพาะ SYN packets\nip.src==192.168.1.100 — จาก IP ที่กำหนด\ntcp.port==443 — เฉพาะ HTTPS\nhttp.request.method==\"POST\" — เฉพาะ HTTP POST"
      },
      {
        "type": "code",
        "language": "bash",
        "code": "# Capture ด้วย tshark\ntshark -i eth0\n\n# Capture เฉพาะ HTTP traffic\ntshark -i eth0 -Y \"http\"\n\n# อ่าน pcap file แสดงเฉพาะ DNS\ntshark -r capture.pcap -Y \"dns\"\n\n# แสดง HTTP requests\ntshark -r capture.pcap -Y \"http.request\" -T fields -e http.host -e http.request.uri\n\n# หา SYN scan patterns\ntshark -r capture.pcap -Y \"tcp.flags.syn==1 && tcp.flags.ack==0\""
      },
      {
        "type": "quiz",
        "question": "คำสั่ง tcpdump ใดใช้จับเฉพาะ traffic port 443?",
        "answer": "tcpdump -i eth0 port 443",
        "hint": "ใช้ filter port ตามด้วยหมายเลข port"
      },
      {
        "type": "quiz",
        "question": "tshark display filter ใดใช้แสดงเฉพาะ HTTP traffic?",
        "answer": "http",
        "hint": "ง่ายมาก! ใช้ชื่อ protocol ตรงๆ"
      },
      {
        "type": "quiz",
        "question": "ถ้าต้องการบันทึก packet capture เป็นไฟล์ ต้องใช้ option ใดกับ tcpdump?",
        "answer": "-w",
        "hint": "w = write"
      }
    ]
  },
  {
    "id": "firewall",
    "title": "Firewall & IDS/IPS",
    "sections": [
      {
        "type": "content",
        "heading": "Firewall คืออะไร?",
        "text": "Firewall คือ กำแพง ที่กรอง traffic เข้า-ออกเครือข่าย:\n\nประเภท:\nPacket Filter — กรองตาม IP/Port/Protocol\nStateful Firewall — จำ connection state\nApplication Firewall — ตรวจ Layer 7 (WAF)\nNext-Gen Firewall (NGFW) — DPI + IPS + Threat Intelligence\n\nDefault Deny Policy:\nBlock ทุกอย่างก่อน แล้วค่อย Allow เฉพาะที่จำเป็น ปลอดภัยกว่า Default Allow แต่ต้อง configure ดี"
      },
      {
        "type": "content",
        "heading": "UFW — Uncomplicated Firewall",
        "text": "UFW เป็น frontend ของ iptables ที่ใช้ง่ายกว่า เหมาะสำหรับ Ubuntu/Debian servers\nคำสั่งหลัก: ufw enable, ufw disable, ufw status, ufw allow, ufw deny, ufw delete"
      },
      {
        "type": "code",
        "language": "bash",
        "code": "# เปิด/ปิด UFW\nsudo ufw enable\nsudo ufw disable\nsudo ufw status verbose\n\n# Allow SSH\nsudo ufw allow 22/tcp\n\n# Allow HTTP + HTTPS\nsudo ufw allow 80/tcp\nsudo ufw allow 443/tcp\n\n# Block IP ที่น่าสงสัย\nsudo ufw deny from 10.0.0.99\n\n# Allow เฉพาะ subnet\nsudo ufw allow from 192.168.1.0/24 to any port 22"
      },
      {
        "type": "content",
        "heading": "iptables — Linux Packet Filter",
        "text": "iptables เป็น firewall ระดับ kernel ของ Linux:\n\nChains:\nINPUT — traffic เข้ามาหาเครื่อง\nOUTPUT — traffic ออกจากเครื่อง\nFORWARD — traffic ผ่านเครื่อง (router)\n\nTargets:\nACCEPT — อนุญาต\nDROP — ทิ้งเงียบ\nREJECT — ปฏิเสธ + ส่ง error กลับ\nLOG — บันทึก log"
      },
      {
        "type": "content",
        "heading": "IDS/IPS — Intrusion Detection/Prevention",
        "text": "IDS (Intrusion Detection System) — ตรวจจับภัยคุกคาม แจ้งเตือน แต่ไม่ block\nIPS (Intrusion Prevention System) — ตรวจจับ + block อัตโนมัติ\n\nเครื่องมือ:\nSnort — Open-source IDS/IPS (rule-based)\nSuricata — Multi-threaded IDS/IPS\nOSSEC — Host-based IDS (HIDS)\nFail2ban — Auto-ban brute force IPs\n\nSnort Rule ตัวอย่าง: alert tcp any any -> $HOME_NET 22 (msg:\"SSH Brute Force\"; threshold: type both, track by_src, count 5, seconds 60; sid:100001;)\nอ่าน: ถ้า TCP มาที่ port 22 มากกว่า 5 ครั้งใน 60 วินาที → แจ้งเตือน"
      },
      {
        "type": "quiz",
        "question": "คำสั่ง UFW ใดใช้อนุญาต SSH?",
        "answer": "ufw allow 22/tcp",
        "hint": "allow + port 22 + protocol tcp"
      },
      {
        "type": "quiz",
        "question": "IDS กับ IPS ต่างกันอย่างไร?",
        "answer": "IDS ตรวจจับและแจ้งเตือน IPS ตรวจจับและ block",
        "hint": "D=Detection (แจ้งเตือน), P=Prevention (ป้องกัน)"
      },
      {
        "type": "quiz",
        "question": "iptables chain ใดใช้กรอง traffic ที่เข้ามาหาเครื่อง?",
        "answer": "INPUT",
        "hint": "traffic เข้า = IN..."
      }
    ]
  }
]
